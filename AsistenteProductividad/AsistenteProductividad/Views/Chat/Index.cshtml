@{
    ViewBag.Title = "Agente IA para mejorar tu Productividad";
}

<h2 class="text-center mb-4">@ViewBag.Title</h2>

<div class="container">
    <div class="row justify-content-center">

        <!-- Columna del chat (más a la derecha) -->
        <div class="col-md-7">

            <div class="card shadow-sm">
                <div class="card-body">

                    <div id="chat-box"
                         style="height:400px; overflow-y:auto; border-radius:10px; background-color:#f8f9fa; padding:15px; border:1px solid #e0e0e0;">
                    </div>

                    <div class="d-flex mt-3">
                        <input type="text" id="prompt" placeholder="Escribe tu mensaje..."
                               class="form-control" />
                        <button id="enviar" class="btn btn-primary ms-2">Enviar</button>
                    </div>

                </div>
            </div>

        </div>

        <!-- Columna lateral con tips -->
        <div class="col-md-4">

            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    💡 Tips para usar el agente IA
                </div>
                <div class="card-body">
                    <ul>
                        <li>Sea claro con las instrucciones.</li>
                        <li>Usa frases cortas y presisas para obtener mejores respuestas.</li>
                        <li>Pide ejemplos cuando necesites aprender algo.</li>
                        <li>Ten claro que aspectos quieres mejorar.</li>
                        <li>Recuerda, ten paciencia mientras el agente te responde, dura unos segundo.</li>
                    </ul>
                </div>
            </div>

        </div>

    </div>
</div>

@section Scripts {
    <script>
                function agregarMensaje(usuario, mensaje, color) {

            var bubble = $("<div>").addClass("msg-bubble");

            if (usuario === "Tú") {
                bubble.addClass("msg-user");
            } else {
                bubble.addClass("msg-agent");
            }

            bubble.html("<strong>" + usuario + ":</strong> " + mensaje);

            $("#chat-box").append(bubble);
            $("#chat-box").scrollTop($("#chat-box")[0].scrollHeight);
        }


        $("#enviar").click(function () {
            var prompt = $("#prompt").val();
            if (!prompt) return;

            agregarMensaje("Tú", prompt, "black");
            $("#prompt").val("");

            $.post("@Url.Action("Enviar", "Chat")", { prompt: prompt }, function (data) {
                agregarMensaje("Agente", data.respuesta, "blue");
            });
        });

        $("#prompt").keypress(function (e) {
            if (e.which == 13) {
                $("#enviar").click();
                return false;
            }
        });
    </script>
}
